#Set virtualenv
#python3 -m venv ${APPDIR}/${VENV_NAME}
#Activate the virtual environment
#source ${APPDIR}/${VENV_NAME}/bin/activate
#Now you are on the virtual env -> deactivate to quit
#installing uwsgi on the virtual environment
#pip install wheel uwsgi flask
#deactivate


sed -i "s/APPNAME/${APPNAME}/g" ${WD}/rc.local
sed -i "s/APPDIR/\/home\/$USER\/webapps/g" ${WD}/rc.local


https://raspberrytips.com/upgrade-raspbian-lite-to-desktop/
https://github.com/RPi-Distro/raspi-config/blob/master/raspi-config


####
####EDITING LXFCE COFIG  FILE
####
####

LXDE_P="/etc/xdg/lxsession/LXDE-pi/autostart"

if [ ! -e ${LXDE_P} ]
then
	touch ${LXDE_P}
fi

echo "lxpanel --profile LXDE-pi" >> "${LXDE_P}"
echo "@pcmanfm --desktop --profile LXDE-pi" >> "${LXDE_P}"
#Edit boot graphical configuration
#Desactivate power managment and blanking screen
echo "@xscreensaver -no-splash" >> "${LXDE_P}"
echo "@point-rpi" >> "${LXDE_P}"
echo "@xset s off" >> "${LXDE_P}"
echo "@xset -dpms" >> "${LXDE_P}"
echo "@xset s noblank" >> "${LXDE_P}"
#Prevent error messages
echo "@sed -i 's/"exited_cleanly": false/"exited_cleanly": true/' ~/.config/chromium/Default/Preferences" >> "${LXDE_P}"
#echo "@chromium --noerrdialogs --kiosk ${HOMEPAGE} --incognito" >> "${LXDE_P} "


####EDIT rc.local

/usr/local/bin/uwsgi --ini /APPDIR/APPNAME.ini --uid www-data --gid www-data --daemonize /var/log/uwsgi.log

exit 0
